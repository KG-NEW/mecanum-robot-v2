{"entries":[{"timestamp":1767493428326,"editorVersion":"8.0.18","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":84,"diffs":[[1,"<xml xmlns=\"http://www.w3.org/1999/xhtml\">\n  <block type=\"pxt-on-start\"></block>\n  <block type=\"device_forever\"></block>\n</xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":0,"length1":33,"diffs":[[1,"\n"]]}]},{"type":"edited","filename":"pxt.json","patch":[{"start1":212,"length1":41,"diffs":[[1,"        \"README.md\"\n"]]},{"start1":239,"length1":75,"diffs":[[1,"    \"additionalFilePaths\": []\n"]]}]},{"type":"added","filename":"test.ts","value":"// tests go here; this will not be compiled when this package is used as an extension.\n"},{"type":"added","filename":"custom.ts","value":"/**\n * use for RGB-LED\n */\nenum COLOR {\n    red,\n    green,\n    blue,\n    white,\n    black\n}\n/**\n  * Pre-Defined LED colours\n  */\nenum vColors {\n    //% block=red\n    Red = 0xff0000,\n    //% block=orange\n    Orange = 0xffa500,\n    //% block=yellow\n    Yellow = 0xffff00,\n    //% block=green\n    Green = 0x00ff00,\n    //% block=blue\n    Blue = 0x0000ff,\n    //% block=indigo\n    Indigo = 0x4b0082,\n    //% block=violet\n    Violet = 0x8a2be2,\n    //% block=purple\n    Purple = 0xff00ff,\n    //% block=white\n    White = 0xffffff,\n    //% block=black\n    Black = 0x000000\n}\n/**\n * use for control motor\n */\nenum DIR {\n    Run_forward = 0,\n    Run_back = 1,\n    Turn_Left = 2,\n    Turn_Right = 3\n}\nenum LR {\n    Upper_left = 0,\n    Lower_left = 1,\n    Upper_right = 2,\n    Lower_right = 3,\n}\nenum MotorState {\n    stop = 0,\n    brake = 1\n}\nenum MD {\n    Forward = 0,\n    Back = 1\n}\n\nenum LT {\n    Left,\n    Center,\n    Right\n\n}\n\nenum LedCount {\n    Left = 0x09,\n    Right = 0x0a\n}\n\nenum LedState {\n    ON = 4095,\n    OFF = 0\n}\n\nenum Servo_num {\n    D14,\n    D15\n}\n\n//% color=\"#ff6800\" icon=\"\\uf1b9\" weight=15\n//% groups=\"['Motor', 'Servo', 'led', 'Neo-pixel', 'Sensor', 'Tone']\"\nnamespace mecanumRobotV2 {\n    /**\n     * use for control PCA9685\n     */\n    export enum Servos {\n        D14 = 14,\n        D15 = 15\n    }\n\n    const STC15_ADDRESS = 0x30;   //device address\n\n    // function i2cRead(addr: number, reg: number) {\n    //     pins.i2cWriteNumber(addr, reg, NumberFormat.UInt8BE);\n    //     let val = pins.i2cReadNumber(addr, NumberFormat.UInt8BE);\n    //     return val;\n    // }\n\n    function i2cWrite(STC15_ADDRESS: number, reg: number, value: number) {\n        let buf = pins.createBuffer(2)\n        buf[0] = reg\n        buf[1] = value\n        pins.i2cWriteBuffer(STC15_ADDRESS, buf)\n    }\n\n\n    /**\n     * set speed of motor\n     */\n    //% block=\"Motor $M run $D speed: $speed \\\\%\"\n    //% speed.min=0 speed.max=100\n    //% group=\"Motor\" weight=97\n    export function Motor(M: LR, D: MD, speed: number) {\n        // if (!PCA9685_Initialized) {\n        //     init_PCA9685();\n        // }\n        let speed_value = Math.map(speed, 0, 100, 0, 255);\n        //电机1\n        //正转\n        if (M == 2 && D == 1) {\n            i2cWrite(0x30, 0x01, speed_value); //M1A\n            i2cWrite(0x30, 0x02, 0); //M1B\n        }\n        //反转\n        if (M == 2 && D == 0) {\n            i2cWrite(0x30, 0x01, 0); //M1A\n            i2cWrite(0x30, 0x02, speed_value); //M1B\n        }\n\n        //电机2\n        if (M == 0 && D == 0) {\n            i2cWrite(0x30, 0x03, 0); //M2A\n            i2cWrite(0x30, 0x04, speed_value); //M2B\n        }\n        if (M == 0 && D == 1) {\n            i2cWrite(0x30, 0x03, speed_value); //M2A\n            i2cWrite(0x30, 0x04, 0); //M2B\n        }\n        //电机3\n        if (M == 3 && D == 1) {\n            i2cWrite(0x30, 0x05, speed_value); //M3A\n            i2cWrite(0x30, 0x06, 0); //M3B\n        }\n        if (M == 3 && D == 0) {\n            i2cWrite(0x30, 0x05, 0); //M3A\n            i2cWrite(0x30, 0x06, speed_value); //M3B\n        }\n        //电机4\n        if (M == 1 && D == 0) {\n            i2cWrite(0x30, 0x07, 0); //M4A\n            i2cWrite(0x30, 0x08, speed_value); //M4B\n        }\n        if (M == 1 && D == 1) {\n            i2cWrite(0x30, 0x07, speed_value); //M4A\n            i2cWrite(0x30, 0x08, 0); //M4B\n        }\n\n    }\n\n\n    /**\n     * set cat state\n     */\n    //% block=\"car Stop\"\n    //% group=\"Motor\" weight=98\n    export function state() {\n        //if (!PCA9685_Initialized) {\n        //init_PCA9685();\n        //}\n\n        //stop\n        i2cWrite(0x30, 0x01, 0); //M1A\n        i2cWrite(0x30, 0x02, 0); //M1B\n        i2cWrite(0x30, 0x03, 0); //M1A\n        i2cWrite(0x30, 0x04, 0); //M1B\n        i2cWrite(0x30, 0x05, 0); //M1A\n        i2cWrite(0x30, 0x06, 0); //M1B\n        i2cWrite(0x30, 0x07, 0); //M1A\n        i2cWrite(0x30, 0x08, 0); //M1B\n    }\n\n\n    /**\n     * turn off all rgb-led\n     */\n    //% block=\"$LedC Colorful LED turn $LedS\"\n    //% group=\"led\" weight=76\n    export function setLed(LedC: LedCount, LedS: LedState) {\n        i2cWrite(0x30, LedC, LedS);\n    }\n\n    //% block=\"set servo to angle %angle\"\n    //% group=\"Servo\" weight=70\n    //% angle.min=-90 angle.max.max=90\n    export function setServo(angle: number): void {\n        pins.servoWritePin(AnalogPin.P14, angle)\n    }\n\n\n\n\n    /////////////////////////////////////////////////////\n    //% block=\"$LT_val LineTracking\"\n    //% group=\"Sensor\" weight=69\n    export function LineTracking(LT_val: LT) {\n        let val = 0;\n        let lt = LT_val;\n        switch (lt) {\n            case LT.Left:\n                val = pins.digitalReadPin(DigitalPin.P3);\n                break;\n            case LT.Right:\n                val = pins.digitalReadPin(DigitalPin.P10);\n                break;\n            case LT.Center:\n                val = pins.digitalReadPin(DigitalPin.P4);\n                break;\n        }\n        // val = (pins.digitalReadPin(DigitalPin.P14)<<2) + \n        //       (pins.digitalReadPin(DigitalPin.P15)<<1) +\n        //       (pins.digitalReadPin(DigitalPin.P16));\n        return val;\n    }\n    /**\n     * Ultrasonic sensor\n     */\n    let lastTime = 0;\n    //% block=\"Ultrasonic\"\n    //% group=\"Sensor\" weight=68\n    export function ultra(): number {\n        //send trig pulse\n        pins.setPull(DigitalPin.P15, PinPullMode.PullNone);\n        pins.digitalWritePin(DigitalPin.P15, 0)\n        control.waitMicros(2);\n        pins.digitalWritePin(DigitalPin.P15, 1)\n        control.waitMicros(10);\n        pins.digitalWritePin(DigitalPin.P15, 0)\n\n        // read echo pulse  max distance : 6m(35000us)  \n        let t = pins.pulseIn(DigitalPin.P16, PulseValue.High, 35000);\n        let ret = t;\n\n        //Eliminate the occasional bad data\n        if (ret == 0 && lastTime != 0) {\n            ret = lastTime;\n        }\n        lastTime = t;\n\n        return Math.round(ret / 58);\n    }\n\n}\n"}]}],"snapshots":[{"timestamp":1767493428325,"editorVersion":"8.0.18","text":{"main.blocks":"<xml xmlns=\"http://www.w3.org/1999/xhtml\">\n  <block type=\"pxt-on-start\"></block>\n  <block type=\"device_forever\"></block>\n</xml>","main.ts":"\n","README.md":"","pxt.json":"{\n    \"name\": \"mecanum-robot-V2\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"core\": \"*\",\n        \"radio\": \"*\",\n        \"microphone\": \"*\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\"\n    ],\n    \"additionalFilePaths\": []\n}\n"}}],"shares":[],"lastSaveTime":1767493471265}